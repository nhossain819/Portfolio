/*This file is currently being updated*/

/*The dataset used here is available in all SAS platforms.*/
data heartdata;
	set sashelp.heart
		(rename=(DeathCause=CauseOfDeath)
			keep=Status DeathCause AgeCHDdiag AgeAtStart Height Weight);
	if AgeAtStart > 30 and AgeAtStart < 50;
run;

proc sql;
create table heartdata2 as
	(
	select Status 
		, AgeAtStart 
		, avg(AgeCHDdiag) as AverageAgeCHDdiag  
		, avg(Height) as AverageHeight    
		, avg(Weight) as AverageWeight
	from heartdata
	group by Status, AgeAtStart
	)
	order by Status, AgeAtStart
	;
quit;


proc print data=heartdata2 (firstobs=10 obs=20);
run;


ods excel file="/folders/myfolders/HeartStudy.xlsx" 
options
	(
	start_at="3,3"
	frozen_headers="5"
	frozen_rowheaders="3"
	sheet_name="Heart_Study"
	embedded_titles="yes"
	);
 
proc print data=heartdata2; 
title "Average Height, Weight, and AgeCHDdiag by Status and Age";
run;
 
ods excel close;
